"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tryGetErrorMessage = (err) => {
    try {
        return JSON.stringify(err.originalError.response.data);
    }
    catch (err) {
        return '';
    }
};
exports.lineReply = (replyToken, message, lineClient) => {
    var messages = [];
    if (typeof message === 'string') {
        messages = [{
                text: message,
                type: 'text'
            }];
    }
    else if (Array.isArray(message)) {
        message.forEach(msg => {
            if (typeof msg === 'string') {
                let singleMessage = {
                    text: msg,
                    type: 'text'
                };
                messages.push(singleMessage);
            }
            else {
                messages.push(msg);
            }
        });
    }
    else {
        if (!message)
            throw new Error('You LINE message is empty');
        if (!message.type)
            throw new Error('Your LINE message is required to have a type');
        // object type message
        messages = [message];
    }
    return lineClient.replyMessage(replyToken, messages)
        .catch(err => {
        console.error(`replyMessage error: ${tryGetErrorMessage(err)}`);
    });
};
module.exports = exports.lineReply;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVzcG9uZGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NoYXRib3RzL3dlYmhvb2svbGluZS9yZXNwb25kZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxNQUFNLGtCQUFrQixHQUFHLENBQUMsR0FBRyxFQUFFLEVBQUU7SUFDakMsSUFBSTtRQUNGLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQTtLQUN2RDtJQUFDLE9BQU8sR0FBRyxFQUFFO1FBQ1osT0FBTyxFQUFFLENBQUE7S0FDVjtBQUNILENBQUMsQ0FBQTtBQUVZLFFBQUEsU0FBUyxHQUFHLENBQUMsVUFBVSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsRUFBRTtJQUMzRCxJQUFJLFFBQVEsR0FBRyxFQUFFLENBQUE7SUFDakIsSUFBSSxPQUFPLE9BQU8sS0FBSyxRQUFRLEVBQUU7UUFDL0IsUUFBUSxHQUFHLENBQUM7Z0JBQ1YsSUFBSSxFQUFFLE9BQU87Z0JBQ2IsSUFBSSxFQUFFLE1BQU07YUFDYixDQUFDLENBQUE7S0FDSDtTQUFNLElBQUksS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtRQUNqQyxPQUFPLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lBQ3BCLElBQUksT0FBTyxHQUFHLEtBQUssUUFBUSxFQUFFO2dCQUMzQixJQUFJLGFBQWEsR0FBRztvQkFDbEIsSUFBSSxFQUFFLEdBQUc7b0JBQ1QsSUFBSSxFQUFFLE1BQU07aUJBQ2IsQ0FBQTtnQkFDRCxRQUFRLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFBO2FBQzdCO2lCQUFNO2dCQUNMLFFBQVEsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUE7YUFDbkI7UUFDSCxDQUFDLENBQUMsQ0FBQTtLQUNIO1NBQU07UUFDTCxJQUFJLENBQUMsT0FBTztZQUFFLE1BQU0sSUFBSSxLQUFLLENBQUMsMkJBQTJCLENBQUMsQ0FBQTtRQUMxRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUk7WUFBRSxNQUFNLElBQUksS0FBSyxDQUFDLDhDQUE4QyxDQUFDLENBQUE7UUFFbEYsc0JBQXNCO1FBQ3RCLFFBQVEsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0tBQ3JCO0lBRUQsT0FBTyxVQUFVLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxRQUFRLENBQUM7U0FDakQsS0FBSyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ1gsT0FBTyxDQUFDLEtBQUssQ0FBQyx1QkFBdUIsa0JBQWtCLENBQUMsR0FBRyxDQUFDLEVBQUUsQ0FBQyxDQUFBO0lBQ2pFLENBQUMsQ0FBQyxDQUFBO0FBRU4sQ0FBQyxDQUFBO0FBRUQsTUFBTSxDQUFDLE9BQU8sR0FBRyxpQkFBUyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgdHJ5R2V0RXJyb3JNZXNzYWdlID0gKGVycikgPT4ge1xuICB0cnkge1xuICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShlcnIub3JpZ2luYWxFcnJvci5yZXNwb25zZS5kYXRhKVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gJydcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgbGluZVJlcGx5ID0gKHJlcGx5VG9rZW4sIG1lc3NhZ2UsIGxpbmVDbGllbnQpID0+IHtcbiAgdmFyIG1lc3NhZ2VzID0gW11cbiAgaWYgKHR5cGVvZiBtZXNzYWdlID09PSAnc3RyaW5nJykge1xuICAgIG1lc3NhZ2VzID0gW3tcbiAgICAgIHRleHQ6IG1lc3NhZ2UsXG4gICAgICB0eXBlOiAndGV4dCdcbiAgICB9XVxuICB9IGVsc2UgaWYgKEFycmF5LmlzQXJyYXkobWVzc2FnZSkpIHtcbiAgICBtZXNzYWdlLmZvckVhY2gobXNnID0+IHtcbiAgICAgIGlmICh0eXBlb2YgbXNnID09PSAnc3RyaW5nJykge1xuICAgICAgICBsZXQgc2luZ2xlTWVzc2FnZSA9IHtcbiAgICAgICAgICB0ZXh0OiBtc2csXG4gICAgICAgICAgdHlwZTogJ3RleHQnXG4gICAgICAgIH1cbiAgICAgICAgbWVzc2FnZXMucHVzaChzaW5nbGVNZXNzYWdlKVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbWVzc2FnZXMucHVzaChtc2cpXG4gICAgICB9XG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICBpZiAoIW1lc3NhZ2UpIHRocm93IG5ldyBFcnJvcignWW91IExJTkUgbWVzc2FnZSBpcyBlbXB0eScpXG4gICAgaWYgKCFtZXNzYWdlLnR5cGUpIHRocm93IG5ldyBFcnJvcignWW91ciBMSU5FIG1lc3NhZ2UgaXMgcmVxdWlyZWQgdG8gaGF2ZSBhIHR5cGUnKVxuXG4gICAgLy8gb2JqZWN0IHR5cGUgbWVzc2FnZVxuICAgIG1lc3NhZ2VzID0gW21lc3NhZ2VdXG4gIH1cblxuICByZXR1cm4gbGluZUNsaWVudC5yZXBseU1lc3NhZ2UocmVwbHlUb2tlbiwgbWVzc2FnZXMpXG4gICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGByZXBseU1lc3NhZ2UgZXJyb3I6ICR7dHJ5R2V0RXJyb3JNZXNzYWdlKGVycil9YClcbiAgICB9KVxuXG59XG5cbm1vZHVsZS5leHBvcnRzID0gbGluZVJlcGx5XG4iXX0=